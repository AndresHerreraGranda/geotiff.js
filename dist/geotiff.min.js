!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d=a("./globals.js"),e=(d.fieldTags,d.fieldTagNames),f=d.arrayFields,g=d.fieldTypes,h=(d.fieldTypeNames,d.geoKeys,d.geoKeyNames),i=a("./geotiffimage.js"),j=function(a){this.dataView=new DataView(a);var b=this.dataView.getUint16(0,0);if(18761===b)this.littleEndian=!0;else{if(19789!==b)throw new TypeError("Invalid byte order value.");this.littleEndian=!1}if(42!==this.dataView.getUint16(2,this.littleEndian))throw new TypeError("Invalid magic number.");this.fileDirectories=this.parseFileDirectories(this.dataView.getUint32(4,this.littleEndian))};j.prototype={getFieldTypeLength:function(a){switch(a){case g.BYTE:case g.ASCII:case g.SBYTE:case g.UNDEFINED:return 1;case g.SHORT:case g.SSHORT:return 2;case g.LONG:case g.SLONG:case g.FLOAT:return 4;case g.RATIONAL:case g.SRATIONAL:case g.DOUBLE:return 8;default:throw new RangeError("Invalid field type: "+a)}},getValues:function(a,b,c){var d,e=null,f=null,h=this.getFieldTypeLength(a);switch(a){case g.BYTE:case g.ASCII:case g.UNDEFINED:e=new Uint8Array(b),f=this.dataView.getUint8;break;case g.SBYTE:e=new Int8Array(b),f=this.dataView.getInt8;break;case g.SHORT:e=new Uint16Array(b),f=this.dataView.getUint16;break;case g.SSHORT:e=new Int16Array(b),f=this.dataView.getInt16;break;case g.LONG:e=new Uint32Array(b),f=this.dataView.getUint32;break;case g.SLONG:e=new Int32Array(b),f=this.dataView.getInt32;break;case g.RATIONAL:e=new Uint32Array(2*b),f=this.dataView.getUint32;break;case g.SRATIONAL:e=new Int32Array(2*b),f=this.dataView.getInt32;break;case g.FLOAT:e=new Float32Array(b),f=this.dataView.getFloat32;break;case g.DOUBLE:e=new Float64Array(b),f=this.dataView.getFloat64;break;default:throw new RangeError("Invalid field type: "+a)}if(a!==g.RATIONAL&&a!==g.SRATIONAL)for(d=0;b>d;++d)e[d]=f.call(this.dataView,c+d*h,this.littleEndian);else for(d=0;2*b>d;d+=2)e[d]=f.call(this.dataView,c+d*h,this.littleEndian),e[d+1]=f.call(this.dataView,c+(d+1)*h,this.littleEndian);return a===g.ASCII?String.fromCharCode.apply(null,e):e},getFieldValues:function(a,b,c,d){var e,h=this.getFieldTypeLength(b);if(4>=h*c)e=this.getValues(b,c,d);else{var i=this.dataView.getUint32(d,this.littleEndian);e=this.getValues(b,c,i)}return 1===c&&-1===f.indexOf(a)&&b!==g.RATIONAL&&b!==g.SRATIONAL?e[0]:e},parseGeoKeyDirectory:function(a){var b=a.GeoKeyDirectory;if(!b)return null;for(var c={},d=4;d<4*b[3];d+=4){var f=h[b[d]],g=b[d+1]?e[b[d+1]]:null,i=b[d+2],j=b[d+3],k=null;if(g){if(k=a[g],"undefined"==typeof k||null===k)throw new Error("Could not get value of geoKey '"+f+"'.");"string"==typeof k?k=k.substring(j,j+i-1):k.subarray&&(k=k.subarray(j,j+i-1))}else k=j;c[f]=k}return c},parseFileDirectories:function(a){for(var b=a,c=[];0!==b;){for(var d=this.dataView.getUint16(b,this.littleEndian),f={},g=a+2,h=0;d>h;g+=12,++h){var i=this.dataView.getUint16(g,this.littleEndian),j=this.dataView.getUint16(g+2,this.littleEndian),k=this.dataView.getUint32(g+4,this.littleEndian);f[e[i]]=this.getFieldValues(i,j,k,g+8)}c.push([f,this.parseGeoKeyDirectory(f)]),b=this.dataView.getUint32(g,this.littleEndian)}return c},getImage:function(a){a=a||0;var b=this.fileDirectories[a];if(!b)throw new RangeError("Invalid image index");return new i(b[0],b[1],this.dataView,this.littleEndian)}},b.exports=j},{"./geotiffimage.js":2,"./globals.js":3}],2:[function(a,b,c){var d=a("./globals.js"),e=(d.fieldTags,d.fieldTagNames,d.arrayFields,d.fieldTypes,d.fieldTypeNames,function(a,b,c){for(var d=0,e=b;c>e;++e)d+=a[e];return d}),f=function(a,b,c,d){this.fileDirectory=a,this.geoKeys=b,this.dataView=c,this.littleEndian=d,this.tiles={},this.isTiled=a.StripOffsets?!1:!0;var e=a.PlanarConfiguration;if(this.planarConfiguration="undefined"==typeof e?1:e,1!==this.planarConfiguration&&2!==this.planarConfiguration)throw new Error("Invalid planar configuration.")};f.prototype={getFileDirectory:function(){return this.fileDirectory},getGeoKeys:function(){return this.geoKeys},getWidth:function(){return this.fileDirectory.ImageWidth},getHeight:function(){return this.fileDirectory.ImageLength},getSamplesPerPixel:function(){return this.fileDirectory.SamplesPerPixel},getTileWidth:function(){return this.isTiled?this.fileDirectory.TileWidth:this.getWidth()},getTileHeight:function(){return this.isTiled?this.fileDirectory.TileLength:this.fileDirectory.RowsPerStrip},getBytesPerPixel:function(){for(var a=0,b=0;b<this.fileDirectory.BitsPerSample.length;++b){var c=this.fileDirectory.BitsPerSample[b];if(c%8!==0)throw new Error("Sample bit-width of "+c+" is not supported.");if(c!==this.fileDirectory.BitsPerSample[0])throw new Error("Differing size of samples in a pixel are not supported.");a+=c}return a/8},getSampleByteSize:function(a){if(a>=this.fileDirectory.BitsPerSample.length)throw new RangeError("Sample index "+a+" is out of range.");var b=this.fileDirectory.BitsPerSample[a];if(b%8!==0)throw new Error("Sample bit-width of "+b+" is not supported.");return b/8},decodeBlock:function(a,b,c){var d=this.dataView.buffer.slice(a,a+b);switch(this.fileDirectory.Compression){case 1:return d;case 5:throw new Error("LZW compression not supported.");case 6:throw new Error("JPEG compression not supported.");case 8:throw new Error("Deflate compression not supported.");case 32773:throw new Error("PackBits compression not supported.");default:throw new Error("Unknown compresseion method identifier: "+this.fileDirectory.Compression)}},getReaderForSample:function(a){var b=this.fileDirectory.SampleFormat[a],c=this.fileDirectory.BitsPerSample[a];switch(b){case 1:switch(c){case 8:return DataView.prototype.getUint8;case 16:return DataView.prototype.getUint16;case 32:return DataView.prototype.getUint32}break;case 2:switch(c){case 8:return DataView.prototype.getInt8;case 16:return DataView.prototype.getInt16;case 32:return DataView.prototype.getInt32}break;case 3:switch(c){case 32:return DataView.prototype.getFloat32;case 64:return DataView.prototype.getFloat64}}},getArrayForSample:function(a,b){var c=this.fileDirectory.SampleFormat[a],d=this.fileDirectory.BitsPerSample[a];switch(c){case 1:switch(d){case 8:return new Uint8Array(b);case 16:return new Uint16Array(b);case 32:return new Uint32Array(b)}break;case 2:switch(d){case 8:return new Int8Array(b);case 16:return new Int16Array(b);case 32:return new Int32Array(b)}break;case 3:switch(d){case 32:return new Float32Array(b);case 64:return new Float64Array(b)}}throw Error("Unsupported data format/bitsPerSample")},getTileOrStrip:function(a,b,c){var d,e=Math.ceil(this.getWidth()/this.getTileWidth()),f=Math.ceil(this.getHeight()/this.getTileHeight());if(1===this.planarConfiguration?d=b*e+a:2===this.planarConfiguration&&(d=c*e*f+b*e+a),d in this.tiles,1){var g,h;return this.isTiled?(g=this.fileDirectory.TileOffsets[d],h=this.fileDirectory.TileByteCounts[d]):(g=this.fileDirectory.StripOffsets[d],h=this.fileDirectory.StripByteCounts[d]),this.tiles[d]=this.decodeBlock(g,h)}return this.tiles[d]},_readRaster:function(a,b,c){for(var d=this.getTileWidth(),f=this.getTileHeight(),g=Math.floor(a[0]/d),h=Math.ceil(a[2]/d),i=Math.floor(a[1]/f),j=Math.ceil(a[3]/f),k=(Math.ceil(this.getWidth()/d),a[2]-a[0]),l=(a[3]-a[1],this.getBytesPerPixel()),m=(this.getWidth(),[]),n=[],o=0;o<b.length;++o)1===this.planarConfiguration?m.push(e(this.fileDirectory.BitsPerSample,0,b[o])/8):m.push(0),n.push(this.getReaderForSample(b[o]));for(var p=i;j>=p;++p)for(var q=g;h>=q;++q)for(var r=p*f,s=q*d,t=(p+1)*f,u=(q+1)*d,v=0;v<b.length;++v){var w=b[v];2===this.planarConfiguration&&(l=this.getSampleByteSize(w));for(var x=new DataView(this.getTileOrStrip(q,p,w)),y=Math.max(0,a[1]-r);y<Math.min(f,f-(t-a[3]));++y)for(var z=Math.max(0,a[0]-s);z<Math.min(d,d-(u-a[2]));++z){var A=(y*d+z)*l,B=(y+r-a[1])*k+z+s-a[0];c[v][B]=n[v].call(x,A+m[v],this.littleEndian)}}},readRasters:function(a,b){if(a=a||[0,0,this.getWidth(),this.getHeight()],a[0]<0||a[1]<0||a[2]>this.getWidth()||a[3]>this.getHeight())throw new Error("Select window is out of image bounds.");if(a[0]>a[2]||a[1]>a[3])throw new Error("Invalid subsets");var c,d=a[2]-a[0],e=a[3]-a[1],f=d*e;if(b){for(c=0;c<b.length;++c)if(b[c]>=this.fileDirectory.SamplesPerPixel)throw new RangeError("Invalid sample index '"+b[c]+"'.")}else for(b=[],c=0;c<this.fileDirectory.SamplesPerPixel;++c)b.push(c);var g=[];for(c=0;c<b.length;++c)g.push(this.getArrayForSample(b[c],f));return this._readRaster(a,b,g),g},getTiePoints:function(){if(!this.fileDirectory.ModelTiepoint)return[];for(var a=[],b=0;b<this.fileDirectory.ModelTiepoint.length;b+=6)a.push({i:this.fileDirectory.ModelTiepoint[b],j:this.fileDirectory.ModelTiepoint[b+1],k:this.fileDirectory.ModelTiepoint[b+2],x:this.fileDirectory.ModelTiepoint[b+3],y:this.fileDirectory.ModelTiepoint[b+4],z:this.fileDirectory.ModelTiepoint[b+5]});return a}},b.exports=f},{"./globals.js":3}],3:[function(a,b,c){var d,e={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",340:"SMinSampleValue",341:"SMaxSampleValue",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop",33550:"ModelPixelScale",33922:"ModelTiepoint",34264:"ModelTransformation",34735:"GeoKeyDirectory",34736:"GeoDoubleParams",34737:"GeoAsciiParams"},f={};for(d in e)f[e[d]]=parseInt(d);var g=[f.BitsPerSample,f.ExtraSamples,f.SampleFormat,f.StripByteCounts,f.StripOffsets,f.StripRowCounts,f.TileByteCounts,f.TileOffsets],h={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"},i={};for(d in h)i[h[d]]=parseInt(d);var j={1024:"GTModelTypeGeoKey",1025:"GTRasterTypeGeoKey",1026:"GTCitationGeoKey",2048:"GeographicTypeGeoKey",2049:"GeogCitationGeoKey",2050:"GeogGeodeticDatumGeoKey",2051:"GeogPrimeMeridianGeoKey",2052:"GeogLinearUnitsGeoKey",2053:"GeogLinearUnitSizeGeoKey",2054:"GeogAngularUnitsGeoKey",2055:"GeogAngularUnitSizeGeoKey",2056:"GeogEllipsoidGeoKey",2057:"GeogSemiMajorAxisGeoKey",2058:"GeogSemiMinorAxisGeoKey",2059:"GeogInvFlatteningGeoKey",2060:"GeogAzimuthUnitsGeoKey",2061:"GeogPrimeMeridianLongGeoKey",2062:"GeogTOWGS84GeoKey",3072:"ProjectedCSTypeGeoKey",3073:"PCSCitationGeoKey",3074:"ProjectionGeoKey",3075:"ProjCoordTransGeoKey",3076:"ProjLinearUnitsGeoKey",3077:"ProjLinearUnitSizeGeoKey",3078:"ProjStdParallel1GeoKey",3079:"ProjStdParallel2GeoKey",3080:"ProjNatOriginLongGeoKey",3081:"ProjNatOriginLatGeoKey",3082:"ProjFalseEastingGeoKey",3083:"ProjFalseNorthingGeoKey",3084:"ProjFalseOriginLongGeoKey",3085:"ProjFalseOriginLatGeoKey",3086:"ProjFalseOriginEastingGeoKey",3087:"ProjFalseOriginNorthingGeoKey",3088:"ProjCenterLongGeoKey",3089:"ProjCenterLatGeoKey",3090:"ProjCenterEastingGeoKey",3091:"ProjCenterNorthingGeoKey",3092:"ProjScaleAtNatOriginGeoKey",3093:"ProjScaleAtCenterGeoKey",3094:"ProjAzimuthAngleGeoKey",3095:"ProjStraightVertPoleLongGeoKey",3096:"ProjRectifiedGridAngleGeoKey",4096:"VerticalCSTypeGeoKey",4097:"VerticalCitationGeoKey",4098:"VerticalDatumGeoKey",4099:"VerticalUnitsGeoKey"},k={};for(d in j)k[j[d]]=parseInt(d);b.exports={fieldTags:f,fieldTagNames:e,arrayFields:g,fieldTypes:i,fieldTypeNames:h,geoKeys:k,geoKeyNames:j}},{}],4:[function(a,b,c){!function(){var c=function(b){var c;if("string"==typeof b||b instanceof String){c=new ArrayBuffer(2*b.length);for(var d=new Uint16Array(c),e=0,f=b.length;f>e;e++)d[e]=b.charCodeAt(e)}else{if(!(b instanceof ArrayBuffer))throw new Error("Invalid input data given.");c=b}var g=a("./geotiff.js");return new g(c)};"undefined"!=typeof b&&"undefined"!=typeof b.exports?b.exports.parse=c:"undefined"!=typeof window&&(window.GeoTIFF={parse:c})}()},{"./geotiff.js":1}]},{},[4]);